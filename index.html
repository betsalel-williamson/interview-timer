<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Multi-Timer</title>
    <link rel="stylesheet" href="/src/style.css" />
  </head>
  <body>
    <div id="app" data-testid="app-container" x-data="multiTimerApp()">
      <header>
        <h1>Multi-Timer</h1>
        <p>Practice your interview timing with multiple synchronized timers</p>
      </header>

      <main>
        <!-- Timer List - Front and Center -->
        <section
          class="timer-list"
          data-testid="timer-list"
          x-show="timers.length > 0"
        >
          <div class="timer-controls-header">
            <h2>Active Timers</h2>
            <div class="timer-controls">
              <div class="toggle-container">
                <label class="toggle-switch">
                  <input
                    type="checkbox"
                    data-testid="start-all-button"
                    :checked="hasRunningTimers()"
                    x-on:change="handleToggleChange()"
                    :disabled="isStartStopAllButtonDisabled()"
                  />
                  <span class="toggle-slider"></span>
                  <span class="toggle-label" x-text="getToggleLabel()"></span>
                </label>
              </div>
              <button x-on:click="resetAllTimers()" class="reset-all-btn">
                Reset All
              </button>
            </div>
          </div>
          <div class="timers-grid">
            <template x-for="timer in timers" :key="timer.id">
              <div
                class="timer-card timer-item"
                :data-timer-id="timer.id"
                :class="{
                  'timer-running': timer.status === 'running',
                  'timer-completed': timer.status === 'completed',
                  'timer-ready': timer.status === 'ready'
                }"
              >
                <div class="timer-display" data-testid="timer-display">
                  <!-- Normal display mode -->
                  <template x-if="!timer.isEditing">
                    <div class="timer-display-content">
                      <div
                        class="timer-time clickable"
                        title="Click to edit duration"
                      >
                        <span
                          class="timer-minutes clickable"
                          x-text="formatTime(timer.remainingTime).split(':')[0]"
                          x-on:click="startEditTimer(timer.id, 'minutes')"
                          title="Click to edit minutes"
                        ></span>
                        <span class="timer-separator">:</span>
                        <span
                          class="timer-seconds clickable"
                          x-text="formatTime(timer.remainingTime).split(':')[1]"
                          x-on:click="startEditTimer(timer.id, 'seconds')"
                          title="Click to edit seconds"
                        ></span>
                      </div>
                      <div
                        class="timer-duration"
                        x-text="`of ${formatTime(timer.duration)}`"
                      ></div>
                    </div>
                  </template>

                  <!-- Edit mode -->
                  <template x-if="timer.isEditing">
                    <div class="timer-display-content timer-edit-mode">
                      <div class="timer-edit-inputs" data-testid="edit-inputs">
                        <input
                          type="text"
                          class="timer-edit-minutes"
                          data-testid="edit-minutes"
                          x-model="timer.editMinutes"
                          x-on:keydown.enter="saveEditTimer(timer.id)"
                          x-on:keydown.escape="cancelEditTimer(timer.id)"
                          x-on:keydown.tab="handleTabKey(timer.id, 'minutes', $event)"
                          x-on:input="handleMinutesInput(timer.id, $event)"
                          x-on:blur="handleBlur(timer.id, 'minutes', $event)"
                          x-on:click="focusMinutes(timer.id)"
                          placeholder="MM"
                          maxlength="2"
                          pattern="[0-9]*"
                          inputmode="numeric"
                        />
                        <span class="timer-edit-separator">:</span>
                        <input
                          type="text"
                          class="timer-edit-seconds"
                          data-testid="edit-seconds"
                          x-model="timer.editSeconds"
                          x-on:keydown.enter="saveEditTimer(timer.id)"
                          x-on:keydown.escape="cancelEditTimer(timer.id)"
                          x-on:keydown.tab="handleTabKey(timer.id, 'seconds', $event)"
                          x-on:input="handleSecondsInput(timer.id, $event)"
                          x-on:blur="handleBlur(timer.id, 'seconds', $event)"
                          x-on:click="focusSeconds(timer.id)"
                          placeholder="SS"
                          maxlength="2"
                          pattern="[0-9]*"
                          inputmode="numeric"
                        />
                      </div>
                      <div
                        class="timer-duration"
                        x-text="`of ${formatTime(timer.duration)}`"
                      ></div>
                      <div
                        x-show="timer.editError"
                        class="timer-edit-error"
                        x-text="timer.editError"
                      ></div>
                    </div>
                  </template>
                </div>
                <div class="timer-status" x-text="timer.status"></div>
                <div class="timer-controls">
                  <div class="timer-toggle-container">
                    <label class="timer-toggle-switch">
                      <input
                        type="checkbox"
                        :checked="timer.status === 'running'"
                        x-on:change="toggleTimer(timer.id)"
                      />
                      <span class="timer-toggle-slider"></span>
                      <span
                        class="timer-toggle-label"
                        x-text="getTimerButtonText(timer.status)"
                      ></span>
                    </label>
                  </div>
                  <button
                    x-on:click="removeTimer(timer.id)"
                    class="remove-btn"
                    data-testid="remove-timer"
                  >
                    Remove
                  </button>
                </div>
              </div>
            </template>
          </div>
        </section>

        <!-- Quick Setup for Interview Practice -->
        <section
          class="quick-setup"
          data-testid="quick-timers"
          x-show="timers.length === 0"
        >
          <h2>Quick Setup for Interview Practice</h2>
          <p>Common timer combinations for interview practice:</p>
          <div class="quick-buttons">
            <button x-on:click="addQuickTimers([30, 360, 1140, 1200])">
              Add 30s, 6m, 19m, 20m Timers
            </button>
            <button x-on:click="addQuickTimers([60, 300, 600, 900])">
              Add 1m, 5m, 10m, 15m Timers
            </button>
            <button x-on:click="addQuickTimers([120, 180, 240, 300])">
              Add 2m, 3m, 4m, 5m Timers
            </button>
          </div>
          <div class="individual-quick-timers">
            <button
              data-testid="quick-timer-30s"
              x-on:click="addQuickTimers([30])"
            >
              30s
            </button>
            <button
              data-testid="quick-timer-1m"
              x-on:click="addQuickTimers([60])"
            >
              1m
            </button>
            <button
              data-testid="quick-timer-2m"
              x-on:click="addQuickTimers([120])"
            >
              2m
            </button>
            <button
              data-testid="quick-timer-5m"
              x-on:click="addQuickTimers([300])"
            >
              5m
            </button>
            <button
              data-testid="quick-timer-5s"
              x-on:click="addQuickTimers([5])"
            >
              5s
            </button>
            <button
              data-testid="quick-timer-10s"
              x-on:click="addQuickTimers([10])"
            >
              10s
            </button>
          </div>
        </section>

        <!-- Timer Input Form - Moved to bottom -->
        <section class="timer-form" data-testid="timer-form">
          <h2>Add New Timer</h2>
          <form x-on:submit.prevent="addTimer()">
            <div class="form-row">
              <div class="form-group">
                <label for="minutes">Minutes:</label>
                <input
                  type="number"
                  id="minutes"
                  data-testid="minutes-input"
                  x-model="newTimer.minutes"
                  min="0"
                  max="59"
                  placeholder="0"
                />
              </div>
              <div class="form-group">
                <label for="seconds">Seconds:</label>
                <input
                  type="number"
                  id="seconds"
                  data-testid="seconds-input"
                  x-model="newTimer.seconds"
                  min="0"
                  max="59"
                  placeholder="0"
                />
              </div>
              <div class="form-actions">
                <button
                  type="submit"
                  data-testid="add-timer-button"
                  :disabled="!isValidTimer()"
                >
                  Add Timer
                </button>
                <div class="toggle-container">
                  <label class="toggle-switch">
                    <input
                      type="checkbox"
                      x-model="settings.autoStartNewTimers"
                    />
                    <span class="toggle-slider"></span>
                    <span class="toggle-label">Auto-start</span>
                  </label>
                </div>
              </div>
            </div>
            <div
              x-show="formError"
              class="error-message"
              data-testid="form-error"
              x-text="formError"
            ></div>
          </form>
        </section>
      </main>

      <footer>
        <div class="settings" data-testid="audio-settings">
          <label>
            <input type="checkbox" x-model="settings.audioEnabled" />
            Enable Audio Alerts
          </label>
          <label>
            <input
              type="checkbox"
              data-testid="flash-checkbox"
              x-model="settings.flashEnabled"
            />
            Enable Visual Flash
          </label>
          <label>
            <input
              type="checkbox"
              data-testid="audio-testing-checkbox"
              x-model="settings.audioTestingEnabled"
              x-on:change="settings.audioTestingEnabled ? startAudioTesting() : stopAudioTesting()"
            />
            Enable Audio Testing
            <span
              x-show="audioTestingActive"
              class="audio-testing-indicator"
              data-testid="audio-testing-indicator"
              title="Audio testing is active - you should hear click sounds every second"
            >
              🔊 Testing
            </span>
          </label>
          <label>
            <input
              type="checkbox"
              data-testid="metronome-checkbox"
              x-model="settings.metronomeEnabled"
              x-on:change="handleMetronomeToggle()"
            />
            Enable Metronome
            <span
              x-show="metronomeActive"
              class="audio-testing-indicator"
              data-testid="metronome-indicator"
              title="Metronome is active - you should hear a subtle click every second"
            >
              ♪ Metronome
            </span>
          </label>
        </div>
      </footer>
    </div>

    <script type="module" src="/src/main.js"></script>
  </body>
</html>
